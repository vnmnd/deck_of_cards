Implementation and test ideas were provided by Kevin.
